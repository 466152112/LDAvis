---
title: "Newsgroup Data"
author: "Carson Sievert"
date: "May 28, 2014"
output: 
  html_document:
    self_contained: false
    theme: united
    highlight: tango
---

[LDAvis](https://github.com/cpsievert/LDAvis/) comes prepackaged with some data sets to help quickly demonstrate how to use it. This document visualizes a topic model fit to Newsgroup documents^[See http://qwone.com/~jason/20Newsgroups] created with **LDAvis** and **knitr** ([see here](https://github.com/cpsievert/LDAvis/blob/master/inst/examples/newsgroup.Rmd) for source code). There are four essential components to this data structure:

```{r data, message = FALSE}
library(LDAvis)
data("TwentyNewsgroups", package = "LDAvis")
str(TwentyNewsgroups)
```

The first element of this list - "phi" - is a matrix and is one of the main outputs from an [LDA topic model](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation). Each row of this $\phi$ matrix defines a probability mass function over terms for a given topic. Consequently, the rows of the $\phi$ matrix must sum to 1.

```{r sum}
with(TwentyNewsgroups, summary(rowSums(phi)))
```

The second element of this - "theta" - is a matrix and the other main output from an LDA topic model. Each row of this $\theta$ matrix defines a probability mass function over topics for a given document. Consequently, the rows of the $\theta$ matrix must also sum to 1.

```{r sum}
with(TwentyNewsgroups, summary(rowSums(theta)))
```


At this point, we have an option to create a [shiny](http://shiny.rstudio.com/) based visualization with `runShiny` or we can `createJSON` to derive a JSON object that will feed a standalone webpage. Although the shiny based visualization has a few more controls, the standalone page allows us to browse relevant terms for different topics while preserving [object constancy](http://bost.ocks.org/mike/constancy/) (try clicking on one of the circles below then decreasing the value of $\lambda$). `createJSON` fosters this approach by recomputing the top 30 most relevant terms for each topic (over a grid of values for $\lambda$).^[See [here](http://nlp.stanford.edu/events/illvi2014/papers/sievert-illvi2014.pdf) for the definition and discussion of relevance.]

```{r json, results = 'hide', cache = TRUE}
json <- with(TwentyNewsgroups, 
             createJSON(phi = phi, theta = theta, vocab = vocab,
                doc.length = doc.length, term.frequency = term.frequency))
```

Now that we have `json`, we can use `serVis` function to spit out files required to view the interactive webpage. One can even use this function to upload files as [a gist]() which can then be viewed via [bl.ocks.org]().

```{r serVis}
serVis(json, out.dir = "newsgroup", open.browser = FALSE)
```

TODO: demo different scaling methods (possibly with shiny?)
